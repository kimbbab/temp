<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì‚¼ê°ì§€: ìš´ëª…ì˜ ì£¼ì‚¬ìœ„</title>
    <style>
        /* --- ê²Œì„ ì „ì²´ ìŠ¤íƒ€ì¼ --- */
        body {
            font-family: 'Malgun Gothic', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #f0f2f5;
            color: #333;
        }
        #game-container {
            text-align: center;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
        }

        /* --- 5x5 ê²Œì„ ë³´ë“œ ìŠ¤íƒ€ì¼ --- */
        #game-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            margin: 20px 0;
            border: 2px solid #34495e;
        }
        .cell {
            width: 90px;
            height: 90px;
            background-color: #ecf0f1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            border: 1px solid #bdc3c7;
        }
        .cell:not(.claimed):hover {
            background-color: #d5dbdb;
        }
        
        /* --- íŒ€ë³„ ì ë ¹ì§€ ìŠ¤íƒ€ì¼ --- */
        .cell.sin { background-color: #3498db; color: white; }
        .cell.cos { background-color: #2ecc71; color: white; }
        .cell.tan { background-color: #e67e22; color: white; }
        .cell.claimed { cursor: not-allowed; }


        /* --- ê²Œì„ ì •ë³´ ë° ì»¨íŠ¸ë¡¤ íŒ¨ë„ ìŠ¤íƒ€ì¼ --- */
        #info-panel {
            font-size: 1.2em;
            margin-bottom: 15px;
        }
        .team-sin { color: #3498db; }
        .team-cos { color: #2ecc71; }
        .team-tan { color: #e67e22; }
        
        #controls button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #34495e;
            color: white;
        }
        #controls button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <h1>ğŸ² ì‚¼ê°ì§€: ìš´ëª…ì˜ ì£¼ì‚¬ìœ„</h1>
        <div id="info-panel">
            <p id="turn-info">ê²Œì„ì„ ì‹œì‘í•˜ë ¤ë©´ íŒ€ì„ ì„ íƒí•˜ì„¸ìš”.</p>
            <p id="score-info"></p>
        </div>
        <div id="game-board"></div>
        <div id="controls">
             <p><strong>[ê²Œì„ ë°©ë²•]</strong> â‘  ì ë ¹í•  ë•… ì„ íƒ â†’ â‘¡ ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸° â†’ â‘¢ ê³„ì‚°ì‹ ë§Œë“¤ê¸° (ì œí•œ ì‹œê°„ 2ë¶„)</p>
             <button id="roll-dice-btn" disabled>ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
        </div>
    </div>

    <script>
        // --- 1. ê²Œì„ ì„¤ì • ---
        const boardElement = document.getElementById('game-board');
        const turnInfoElement = document.getElementById('turn-info');
        const scoreInfoElement = document.getElementById('score-info');
        const rollDiceBtn = document.getElementById('roll-dice-btn');

        const boardValues = [
            ["âˆš2", "(âˆš3-1)/2", "âˆš3/2", "(âˆš6-âˆš2)/4", "2"],
            ["3/2", "âˆš3", "1/2", "-1/2", "âˆš6/2"],
            ["âˆš3/3", "(âˆš3+1)/2", "1", "âˆš2/2", "-1"],
            ["1/4", "0", "-âˆš3/2", "2âˆš3", "(2-âˆš3)/2"],
            ["âˆš3-1", "(âˆš6+âˆš2)/4", "3", "2âˆš3/3", "4"]
        ];

        const players = {
            sin: { name: "sin ì™•êµ­", mark: "S", score: 0, colorClass: "team-sin" },
            cos: { name: "cos ì™•êµ­", mark: "C", score: 0, colorClass: "team-cos" },
            tan: { name: "tan ì™•êµ­", mark: "T", score: 0, colorClass: "team-tan" }
        };
        const turnOrder = ["sin", "cos", "tan"];
        let currentPlayerIndex = 0;
        let selectedCell = null;
        let remainingTerritories = 25;

        // --- 2. ê²Œì„ ë¡œì§ ---

        function initializeBoard() {
            boardValues.forEach((row, r) => {
                row.forEach((value, c) => {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    cell.textContent = value;
                    cell.addEventListener('click', () => handleCellClick(cell));
                    boardElement.appendChild(cell);
                });
            });
            updateDisplay();
        }
        
        function updateDisplay() {
            const currentPlayerKey = turnOrder[currentPlayerIndex];
            const currentPlayer = players[currentPlayerKey];
            turnInfoElement.innerHTML = `ğŸ‘‘ <strong class="${currentPlayer.colorClass}">${currentPlayer.name}</strong>ì˜ ì°¨ë¡€ì…ë‹ˆë‹¤.`;
            
            let scores = "<strong>[ì˜í†  í˜„í™©]</strong> ";
            scores += `<span class="team-sin">sin: ${players.sin.score}</span> | `;
            scores += `<span class="team-cos">cos: ${players.cos.score}</span> | `;
            scores += `<span class="team-tan">tan: ${players.tan.score}</span>`;
            scoreInfoElement.innerHTML = scores;
        }

        function handleCellClick(cell) {
            if (cell.classList.contains('claimed')) {
                alert("ì´ë¯¸ ì ë ¹ëœ ë•…ì…ë‹ˆë‹¤.");
                return;
            }
            // ì´ì „ì— ì„ íƒëœ ì…€ì˜ ê°•ì¡° íš¨ê³¼ë¥¼ ì œê±°
            if (selectedCell) {
                selectedCell.style.border = '1px solid #bdc3c7';
            }
            
            selectedCell = cell;
            selectedCell.style.border = '3px solid #f1c40f';
            rollDiceBtn.disabled = false;
            turnInfoElement.innerHTML = `<strong>${cell.textContent}</strong> ë•…ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ì£¼ì„¸ìš”.`;
        }
        
        rollDiceBtn.addEventListener('click', () => {
            if (!selectedCell) {
                alert("ë¨¼ì € ê³µê²©í•  ë•…ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
                return;
            }
            
            const diceRoll = Math.floor(Math.random() * 6) + 1;
            const targetValue = selectedCell.textContent;
            
            alert(`ğŸ² ì£¼ì‚¬ìœ„ ê²°ê³¼: ${diceRoll}\n\nì´ì œ ${diceRoll}ê°œì˜ ì‚¼ê°ë¹„ í•­ì„ ì‚¬ìš©í•˜ì—¬ '${targetValue}'ì„ ë§Œë“œëŠ” ê³„ì‚°ì‹ì„ ì°¾ì•„ì£¼ì„¸ìš”. (ì œí•œ ì‹œê°„ 2ë¶„)`);
            
            const equation = prompt(`'${targetValue}'ì„ ë§Œë“œëŠ” ê³„ì‚°ì‹ì„ ì…ë ¥í•˜ì„¸ìš”:`);

            if (equation) {
                // ì¤‘ìš”: ì •ë‹µ í™•ì¸ì€ í”Œë ˆì´ì–´ë“¤ì´ ì§ì ‘ í•©ë‹ˆë‹¤.
                const isCorrect = confirm(`ì…ë ¥í•œ ê³„ì‚°ì‹:\n${equation}\n\nì´ ê³„ì‚°ì‹ì´ ë§ìŠµë‹ˆê¹Œ? (ë‹¤ë¥¸ íŒ€ì›ë“¤ì´ í™•ì¸í•´ì£¼ì„¸ìš”)`);
                
                if (isCorrect) {
                    claimTerritory(selectedCell);
                    // ì—°ì† ê³µê²© í™•ì¸
                    const isSpecialAttack = confirm("ìì‹  ì™•êµ­ì˜ ì‚¼ê°ë¹„ë§Œ ì‚¬ìš©í–ˆìŠµë‹ˆê¹Œ?");
                    if (isSpecialAttack) {
                        alert("â­ íŠ¹ë³„ ê·œì¹™ ë°œë™! í•œ ë²ˆ ë” ê³µê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!");
                        resetTurn();
                    } else {
                        nextTurn();
                    }
                } else {
                    alert("ğŸ’¥ ê³µê²© ì‹¤íŒ¨! ê³„ì‚°ì‹ì´ í‹€ë ¸ìŠµë‹ˆë‹¤.");
                    nextTurn();
                }
            } else {
                alert("ğŸ’¥ ê³µê²© ì‹¤íŒ¨! ê³„ì‚°ì‹ì„ ì…ë ¥í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                nextTurn();
            }
        });
        
        function claimTerritory(cell) {
            const currentPlayerKey = turnOrder[currentPlayerIndex];
            cell.classList.add('claimed', currentPlayerKey);
            cell.textContent = players[currentPlayerKey].mark;
            players[currentPlayerKey].score++;
            remainingTerritories--;
        }

        function resetTurn() {
            selectedCell.style.border = '1px solid #bdc3c7';
            selectedCell = null;
            rollDiceBtn.disabled = true;
            updateDisplay();
            
            if (remainingTerritories === 0) {
                endGame();
            }
        }

        function nextTurn() {
            currentPlayerIndex = (currentPlayerIndex + 1) % 3;
            resetTurn();
        }
        
        function endGame() {
            let winner = null;
            let maxScore = -1;
            
            for (const key in players) {
                if (players[key].score > maxScore) {
                    maxScore = players[key].score;
                    winner = players[key];
                }
            }
            
            // ë™ì ì í™•ì¸
            const winners = Object.values(players).filter(p => p.score === maxScore);

            let message = "--- ê²Œì„ ì¢…ë£Œ! ---\n\n";
            if (winners.length > 1) {
                message += "ë¬´ìŠ¹ë¶€ì…ë‹ˆë‹¤! " + winners.map(w => w.name).join(', ') + "ì´(ê°€) ê³µë™ìœ¼ë¡œ ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤!";
            } else {
                message += `ğŸ‘‘ ì²œí•˜ë¥¼ í†µì¼í•œ ìµœì¢… ìŠ¹ë¦¬ìëŠ” ${winner.name}ì…ë‹ˆë‹¤! ì¶•í•˜í•©ë‹ˆë‹¤!`;
            }

            turnInfoElement.textContent = "ê²Œì„ ì¢…ë£Œ!";
            alert(message);
            rollDiceBtn.disabled = true;
        }

        // --- 3. ê²Œì„ ì‹œì‘ ---
        initializeBoard();

    </script>
</body>
</html>